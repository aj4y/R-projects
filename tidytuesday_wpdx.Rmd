---
title: "tidytuesday_wpdx"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}

library(tidytuesdayR)
library(tidyverse)
library(lubridate)


```


```{r}

tt <-  tidytuesdayR::tt_load('2021-05-04')

tt

water <- tt$water

```

```{r}

water %>% 
  mutate(report_date = as.Date(report_date,"%m/%d/%Y"))%>%
  mutate(report_year = year(report_date))%>%
  mutate(country_name = as_factor(country_name))%>%
  group_by(country_name)%>%
  summarise(n=n())%>%
  top_n(15)%>%
  mutate(country_name = fct_reorder(country_name,n))%>%
  ggplot(aes(country_name,n))+geom_col()+coord_flip()+
  labs(title = "Countries with most observations on water resources",
       x = 'Country name',
       y= '')

```


```{r}

water %>% 
  mutate(report_date = as.Date(report_date,"%m/%d/%Y"))%>%
  mutate(report_year = year(report_date))%>%
  mutate(country_name = as_factor(country_name))%>%
  count(report_year)%>%
  ggplot(aes(report_year,n))+geom_line()


```

